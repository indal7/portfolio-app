{"ast":null,"code":"import { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../toaster.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction ManageUsersComponent_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 3)(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"select\", 4);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ManageUsersComponent_tr_15_Template_select_ngModelChange_6_listener($event) {\n      const user_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      i0.ɵɵtwoWayBindingSet(user_r2.role, $event) || (user_r2.role = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementStart(7, \"option\", 5);\n    i0.ɵɵtext(8, \"Admin\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"option\", 6);\n    i0.ɵɵtext(10, \"User\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"option\", 7);\n    i0.ɵɵtext(12, \"NA\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"td\")(14, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function ManageUsersComponent_tr_15_Template_button_click_14_listener() {\n      const user_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.updateUserRole(user_r2.id, user_r2.role));\n    });\n    i0.ɵɵtext(15, \"Update Role\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const user_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r2.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", user_r2.role);\n  }\n}\nexport let ManageUsersComponent = /*#__PURE__*/(() => {\n  class ManageUsersComponent {\n    constructor(http, toasterService) {\n      this.http = http;\n      this.toasterService = toasterService;\n      this.users = [];\n      this.apiUrl = environment.apiUrl;\n    }\n    ngOnInit() {\n      this.getUsers();\n    }\n    getUsers() {\n      this.http.get(`${this.apiUrl}/fetch_all_users`).subscribe(response => {\n        if (response.success) {\n          this.users = response.message.users || [];\n          this.toasterService.success('Users loaded successfully!');\n        } else {\n          this.toasterService.error(response.message || 'Error fetching users.');\n        }\n      }, error => {\n        console.error('Error fetching users:', error);\n        this.toasterService.error('Failed to load users. Please try again.');\n      });\n    }\n    updateUserRole(userId, newRole) {\n      const email = localStorage.getItem('userEmail');\n      this.http.put(`${this.apiUrl}/users/${userId}/update_user_role`, {\n        role: newRole,\n        email: email\n      }).subscribe(response => {\n        if (response.success) {\n          this.toasterService.success('User role updated successfully!');\n          this.getUsers(); // Refresh the user list to reflect changes\n        } else {\n          this.toasterService.error(response.message || 'Error updating user role.');\n        }\n      }, error => {\n        console.error('Error updating user role:', error);\n        this.toasterService.error('Failed to update user role. Please try again.');\n      });\n    }\n    static #_ = (() => this.ɵfac = function ManageUsersComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ManageUsersComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.ToasterService));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ManageUsersComponent,\n      selectors: [[\"app-manage-users\"]],\n      decls: 16,\n      vars: 1,\n      consts: [[1, \"users-container\"], [1, \"users-table\"], [\"class\", \"user-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"user-item\"], [3, \"ngModelChange\", \"ngModel\"], [\"value\", \"admin\"], [\"value\", \"user\"], [\"value\", \"NA\"], [1, \"update-role-button\", 3, \"click\"]],\n      template: function ManageUsersComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"Manage Users\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"table\", 1)(4, \"thead\")(5, \"tr\")(6, \"th\");\n          i0.ɵɵtext(7, \"Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"th\");\n          i0.ɵɵtext(9, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"th\");\n          i0.ɵɵtext(11, \"Role\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"th\");\n          i0.ɵɵtext(13, \"Action\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(14, \"tbody\");\n          i0.ɵɵtemplate(15, ManageUsersComponent_tr_15_Template, 16, 3, \"tr\", 2);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(15);\n          i0.ɵɵproperty(\"ngForOf\", ctx.users);\n        }\n      },\n      dependencies: [i3.NgForOf, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgModel],\n      styles: [\".users-container[_ngcontent-%COMP%]{padding:20px;background-color:#f9f9f9;border-radius:8px;box-shadow:0 2px 4px #0000001a;max-width:800px;margin:auto}h2[_ngcontent-%COMP%]{text-align:center;color:#333;margin-bottom:20px}.users-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:10px;text-align:left}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.user-item[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.update-role-button[_ngcontent-%COMP%]{padding:5px 10px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s}.update-role-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}@media (max-width: 600px){.users-table[_ngcontent-%COMP%]{font-size:14px}}\"]\n    }))();\n  }\n  return ManageUsersComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}